<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />

    <!-- üî¥ REQUIRED for mobile responsiveness -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Inside-In Market Strategy</title>

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Optional font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body class="bg-slate-100 min-h-screen flex items-center justify-center">

<div class="w-full max-w-6xl p-4 sm:p-6">

    <!-- Header -->
    <div class="mb-8 text-center">
        <h1 class="text-2xl sm:text-3xl font-bold text-slate-800">
            Inside In Market Strategy for NIFTY-50 stocks
        </h1>

        <p class="text-slate-600 mt-2 text-sm sm:text-base leading-relaxed">
            This script scans NIFTY-50 stocks using Zerodha‚Äôs 1-minute candle stick data.
            It validates data integrity and applies a sequential candle-engulfing filter
            at 09:30, 09:45, and 10:00.
        </p>

        <p class="text-slate-500 mt-1 text-xs sm:text-sm">
            (PS: No data is shown on Saturdays, Sundays, or NSE holidays)
        </p>
    </div>

    <!-- Control Panel -->
    <div class="bg-white rounded-xl shadow-md p-4 sm:p-6 mb-6 flex flex-col md:flex-row items-center gap-4">

        <div class="flex flex-col w-full md:w-1/3">
            <label class="text-sm font-semibold text-slate-700 mb-1">
                Select Trading Date
            </label>
            <input
                type="date"
                id="dateInput"
                min="2020-01-01"
                class="border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"
            />
        </div>

        <div class="flex w-full md:w-auto mt-2 md:mt-6">
            <button
                onclick="runScan()"
                class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold px-6 py-3 rounded-lg shadow transition-all w-full md:w-auto text-base"
            >
                ‚ñ∂ Run Scan
            </button>
        </div>

    </div>

    <!-- Output Panel -->
    <div class="bg-black rounded-xl shadow-lg p-4">

        <div class="flex items-center justify-between mb-3">
            <h2 class="text-green-400 font-semibold text-sm sm:text-base">
                Scanner Output
            </h2>
            <span class="text-xs text-green-500">
                Live backend logs
            </span>
        </div>

        <pre
            id="logs"
            class="text-green-400 text-xs sm:text-sm whitespace-pre-wrap
                   h-[260px] sm:h-[420px]
                   overflow-y-auto bg-black p-4 rounded-lg
                   border border-green-800"
        >
Waiting for scan...
        </pre>

    </div>

    <!-- Footer -->
    <div class="mt-6 text-center text-xs sm:text-sm text-slate-500">
        Powered by Zerodha Kite API ¬∑ Built for systematic intraday analysis
    </div>

</div>

<script>
    const API_BASE = "https://inside-in-strategy-backend.onrender.com";

    document.addEventListener("DOMContentLoaded", () => {
        const today = new Date().toISOString().split("T")[0];
        document.getElementById("dateInput").setAttribute("max", today);
    });

    function runScan() {
        const date = document.getElementById("dateInput").value;
        const logsDiv = document.getElementById("logs");

        if (!date) {
            logsDiv.textContent = "‚ö†Ô∏è Please select a date first.";
            return;
        }

        logsDiv.textContent = "‚è≥ Running scan...\n";

        fetch(`${API_BASE}/scan`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ date })
        })
        .then(res => res.json())
        .then(data => {
            if (data.logs) {
                logsDiv.textContent = data.logs.join("\n");
            } else {
                logsDiv.textContent = "No response from server.";
            }
        })
        .catch(err => {
            logsDiv.textContent = "‚ùå Error connecting to backend.\n" + err;
        });
    }
</script>

</body>
</html>
